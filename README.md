# Disk Drive Failure Prediction Using RNN/LSTM
Disk drives are the back bone of large scale systems employing durable storage mechanisms for storage purpose. Disk drives provide a cost effective and reliable mechanism for data storage and are currently the primary storage devices. But even with the reliability of disk drives, disk failures do happen. Failure of disk drives is a rare event with an annual failure rate of 0.3 - 3% per year. Failure of these drive although rare are costly. It would cause large amounts of data loss. Data loss can disrupt businesses, prohibiting them from providing a product or service to their customers and damage reputations. Loss of financial data can lead to financial losses. Such a loss is further disastrous as the cost is greater than the cost of hardware required to replace the drive entirely. Disk failure prediction is a binary classification problem with labeling disks with one of two classes of failure or healthy with one class being very rare. In recent times deep learning methods based on Recurrent Neural Networks (RNN) have shown great classification results for complex problems. A class of RNN – Long Short Term Memory (LSTM) is ideally suited for time based classification and prediction.

## Architecture
This project implements RNN for analysis for better success rate and large data. RNN is an artificial neural network where output from one layer is fed back as input to the previous layer. In other words, the output vector’s content depends not only on the input but on the entire set of input fed to the system in the past. LSTM is a RNN which was developed by Sepp Hochreiter and Juergen Schmidhuber as a solution to the vanishing gradient problem. LSTM can preserve the error through backpropagation in time and between layers. The learning ability of LSTM is faster and better because of the constant error rate maintained over many time steps.

### Feature Selection
Previous researches have shown that certain SMART attributes have higher correlation to disk failure. Pinheiro et al. concluded that SMART 5, SMART 196, SMART 197 and SMART 198 have high correlation with failure. We have used 10 SMART attributes as features for this prediction. Inconsistent data was removed from the dataset. Null values were replaced with 0.

### Technology Overview
We are using the Sequential implementation of Keras library, which contains linear stack of layers that encapsulates RNN model for deep learning. The method fit in Keras provides parameters like epoch, validation split, and callbacks which help to modify the LSTM system. Spark is used as the distributed system for this project, even though Hadoop has been the solution for large data processing over distributed systems for the past 10 years. Hadoop MapReduce works efficiently for one-pass computation but it is not really efficient in the processing of multi-pass computation and complex algorithm. LSTM model on spark is implemented using the Elephas library files. Elephas uses the machine learning library of SPARK, mlib for various functionality.

### LSTM Model
The model has 3 layers – one input, one output and one hidden layer. The number of cells in hidden layer is 200. The RAW_VALUE of the selected SMART parameters is given as input to the LSTM Model. The output of this model is either 0 (Drive = Ok) or 1(Drive = Failure)

### Learning and Training
The 3D data is divided into testing and training set using scikit learn cross validation function. This function generates a random sample of training and testing data in the specified ratio. The data is divided in ratio of 70:30 as the number of failures should be reasonable in training and testing set. Drive failure data is an example of highly imbalanced classification. Of around 1 million data, there are only 1000 failures which is equal to 0.001 %.
